(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{341:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_1-错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-错误"}},[t._v("#")]),t._v(" 1. 错误")]),t._v(" "),s("p",[t._v("所谓“错误”，就是指让应用程序非正常终止，或者产生特殊影响的场景。"),s("br"),t._v(" "),s("code",[t._v("PHP")]),t._v(" 中错误需要关注三个点：")]),t._v(" "),s("ol",[s("li",[t._v("有哪些错误？")]),t._v(" "),s("li",[t._v("哪些错误需要报告，哪些错误可以忽略？（即如何控制报错）")]),t._v(" "),s("li",[t._v("对那些报告的错误，如何处理？（即如何处理报错）")])]),t._v(" "),s("h3",{attrs:{id:"_1-1-有哪些错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-有哪些错误"}},[t._v("#")]),t._v(" 1.1. 有哪些错误？")]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("在使用错误级别时，强烈建议使用“常量”，而非数值，因为以后版本可能修改数值，但是常量却不会变。")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("数值")]),t._v(" "),s("th",[t._v("常量")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("16")]),t._v(" "),s("td",[s("code",[t._v("E_CORE_ERROR")])]),t._v(" "),s("td",[t._v("初始化错误，致命错误，终止执行")])]),t._v(" "),s("tr",[s("td",[t._v("32")]),t._v(" "),s("td",[s("code",[t._v("E_CORE_WARNGING")])]),t._v(" "),s("td",[t._v("初始化错误，警告")])]),t._v(" "),s("tr",[s("td",[t._v("4")]),t._v(" "),s("td",[s("code",[t._v("E_PARSE")])]),t._v(" "),s("td",[t._v("编译错误，语法解析错误，致命错误，终止执行")])]),t._v(" "),s("tr",[s("td",[t._v("64")]),t._v(" "),s("td",[s("code",[t._v("E_COMPILE_ERROR")])]),t._v(" "),s("td",[t._v("编译错误，致命错误，终止执行")])]),t._v(" "),s("tr",[s("td",[t._v("128")]),t._v(" "),s("td",[s("code",[t._v("E_COMPILTE_WARNING")])]),t._v(" "),s("td",[t._v("编译错误，警告")])]),t._v(" "),s("tr",[s("td",[t._v("1")]),t._v(" "),s("td",[s("code",[t._v("E_ERROR")])]),t._v(" "),s("td",[t._v("运行时错误，致命错误，终止执行")])]),t._v(" "),s("tr",[s("td",[t._v("4096")]),t._v(" "),s("td",[s("code",[t._v("E_RECOVERABLE_ERROR")])]),t._v(" "),s("td",[t._v("运行时错误，可被捕获的致命错误，终止执行")])]),t._v(" "),s("tr",[s("td",[t._v("2")]),t._v(" "),s("td",[s("code",[t._v("E_WARNING")])]),t._v(" "),s("td",[t._v("运行时错误，警告")])]),t._v(" "),s("tr",[s("td",[t._v("4")]),t._v(" "),s("td",[s("code",[t._v("E_NOTICE")])]),t._v(" "),s("td",[t._v("运行时错误，通知")])]),t._v(" "),s("tr",[s("td",[t._v("256")]),t._v(" "),s("td",[s("code",[t._v("E_USER_ERROR")])]),t._v(" "),s("td",[t._v("运行时错误，用户产生错误，由 "),s("code",[t._v("trigger_error()")]),t._v(" 触发，中止执行")])]),t._v(" "),s("tr",[s("td",[t._v("512")]),t._v(" "),s("td",[s("code",[t._v("E_USER_WARNING")])]),t._v(" "),s("td",[t._v("运行时错误，用户产生错误，警告，由 "),s("code",[t._v("trigger_error()")]),t._v(" 触发")])]),t._v(" "),s("tr",[s("td",[t._v("1024")]),t._v(" "),s("td",[s("code",[t._v("E_USER_NOTICE")])]),t._v(" "),s("td",[t._v("运行时错误，用户产生错误，通知，由 "),s("code",[t._v("trigger_error()")]),t._v(" 触发")])]),t._v(" "),s("tr",[s("td",[t._v("16384")]),t._v(" "),s("td",[s("code",[t._v("E_USER_DEPRECATED")])]),t._v(" "),s("td",[t._v("运行时错误，用户产生错误，兼容性，由 "),s("code",[t._v("trigger_error()")]),t._v(" 触发")])]),t._v(" "),s("tr",[s("td",[t._v("2048")]),t._v(" "),s("td",[s("code",[t._v("_E_STRICT")])]),t._v(" "),s("td",[t._v("修改建议")])]),t._v(" "),s("tr",[s("td",[t._v("8192")]),t._v(" "),s("td",[s("code",[t._v("E_DEPRECATED")])]),t._v(" "),s("td",[t._v("兼容性")])]),t._v(" "),s("tr",[s("td",[t._v("32767")]),t._v(" "),s("td",[s("code",[t._v("E_ALL")])]),t._v(" "),s("td",[t._v("所有错误、警告、通知")])])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("注意看上述表格，我并没有按照数值的顺序排列，而是按照了“类别”排列，分别是“初始化错误”，“编译错误”，“运行时错误”，“其他错误”，“全部错误”。"),s("br"),t._v("\n这是有原因的，运行时错误之前的错误，一般发生在我们不可控的地方，这个特性在后面会有注意。")])]),t._v(" "),s("h3",{attrs:{id:"_1-2-如何控制报错"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-如何控制报错"}},[t._v("#")]),t._v(" 1.2 如何控制报错？")]),t._v(" "),s("p",[t._v("所谓“控制报错”，即上述的错误表格中，哪些需要在发生错误时报告，哪些不需要？")]),t._v(" "),s("p",[t._v("通过 "),s("code",[t._v("error_reporting")]),t._v(" 配置项（"),s("code",[t._v("php.ini")]),t._v("）控制全局，或者在运行时通过 "),s("code",[t._v("error_reporting()")]),t._v(" 函数控制当前应用生命周期。")]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("一：上述提过一句，初始化错误、编译错误，发生在开发人员不可控的地方，也就是说一旦发生这两类的错误，只会根据 "),s("code",[t._v("error_reporting")]),t._v(" 配置项来判断是否报错（如果在配置项给定值范围内，则报错；否则不报错）"),s("br"),t._v("\n二：配置项或函数，值为 "),s("code",[t._v("0")]),t._v(" 表示不对任何错误报错，值为 "),s("code",[t._v("-1")]),t._v(" 表示对所有错误报错，值为具体的表格中错误范围（二进制位与、或、非）则对具体范围的错误报错"),s("br"),t._v("\n三：配置项中，如果要控制为“不报告任意错误”，应该显示的指定值为 "),s("code",[t._v("0")]),t._v("，如果是注释掉配置项，"),s("code",[t._v("PHP")]),t._v(" 内部还是有兜底的默认的报错控制，大致为 "),s("code",[t._v("E_ALL & ~E_DEPRECATED")]),s("br"),t._v("\n四：经过我的测试发现，当配置项值为 "),s("code",[t._v("0")]),t._v(" 时，我制造了一些编译错误，发现没有任何报错，因此得到结论："),s("strong",[s("code",[t._v("error_reporting")]),t._v("配置项或者 "),s("code",[t._v("error_reporting()")]),t._v(" 函数，能够完全控制报错（包括初始化、编译、运行时、其他，全部错误）。")])])]),t._v(" "),s("p",[t._v("看如下示例充分理解报错设置，以及报错控制：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# php.ini 中配置")]),t._v("\nerror_reporting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" E_ALL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ~E_DEPRECATED "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ~E_STRICT\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 脚本中的代码")]),t._v("\nerror_reporting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),t._v("              // 末尾缺少分号\n")])])]),s("p",[t._v("这个示例充分解释了上面第一条注意，有的错误发生在运行时之前，运行时设置的报错控制对那些错误控制不了（因为这种场景可能不会有运行时，在错误发生的地方就终止了，即使有也还没执行到这里，所以运行时设置无法控制）。"),s("br"),t._v("\n代码中末尾缺少分号，这个一个解析错误（编译错误）：")]),t._v(" "),s("ul",[s("li",[t._v("错误的理解：在运行时设置了 "),s("code",[t._v("error_reporting(0)")]),t._v(" 表示不报告任何错误，那么后续出现了编译错误，则不应该报错")]),t._v(" "),s("li",[t._v("正确理解：虽然运行时设置不报告任何错误，但是发生的错误是编译错误，在还未运行时之前就产生，因此此时运行时都还没有，则无法控制，则按照配置项的值控制报错，配置值表示会将该类错误报错，因此会报错")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# php.ini 中配置")]),t._v("\nerror_reporting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" E_ALL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ~E_DEPRECATED "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ~E_STRICT\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 脚本中的代码")]),t._v("\nerror_reporting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ntest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("              // 调用未定义的函数\n")])])]),s("p",[t._v("这个示例是上面的反向理解，在初始化、编译阶段并没有错误发生，仅在运行时发现调用了未定义的函数，这是一个致命错误 "),s("code",[t._v("E_ERROR")]),t._v("，但是运行时设置了不报错，因此虽然发生了致命错误但是没有报错（但是脚本会终止执行，见上面表格）。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# php.ini 中的配置")]),t._v("\nerror_reporting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 脚本中的代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),t._v("\n")])])]),s("p",[t._v("这个示例中，没有在运行时设置报错控制，那么完全按照配置值控制报错，配置值表示“不对任意错误报错”，那么在脚本中，即使发生了编译错误，也不会报错（但是脚本会终止执行，见上面表格）。")]),t._v(" "),s("h3",{attrs:{id:"_1-3-如何处理报错"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-如何处理报错"}},[t._v("#")]),t._v(" 1.3 如何处理报错？")]),t._v(" "),s("p",[t._v("所谓“处理报错”，就是指当报错之后，对错误的处理。")]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("关键")]),t._v(" "),s("p",[t._v("那么这里引出一个关键点：只有报了错，才会处理（如果不报错，或者错误不在上面介绍的控制范围内，则不处理）")])]),t._v(" "),s("p",[s("strong",[s("code",[t._v("PHP")]),t._v(" 中处理报错，涉及几个方面：")])]),t._v(" "),s("ul",[s("li",[t._v("不可控的特性，比如是否终止执行？")]),t._v(" "),s("li",[t._v("可控的，是否输出错误信息？")]),t._v(" "),s("li",[t._v("可控的，是否记录日志，日志记录在那里？")])]),t._v(" "),s("h4",{attrs:{id:"_1-3-1-不可控特性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-不可控特性"}},[t._v("#")]),t._v(" 1.3.1 不可控特性")]),t._v(" "),s("p",[t._v("关于“开发人员不可控”的一些特性，是 "),s("code",[t._v("PHP")]),t._v(" 内核定义的一些特性，当发生对应错误时，该有的响应，比如上面表格中有的错误有特殊的说明：终止执行，比如会生成一些错误描述等等。这部分不用了解太多，只需要了解那些会终止执行即可。")]),t._v(" "),s("h4",{attrs:{id:"_1-3-2-是否输出错误信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-是否输出错误信息"}},[t._v("#")]),t._v(" 1.3.2 是否输出错误信息？")]),t._v(" "),s("p",[t._v("是否将错误信息（不可控的部分生成的）输出到客户端？"),s("br"),t._v("\n通过 "),s("code",[t._v("display_errors")]),t._v(" 配置项全局配置，或者 "),s("code",[t._v("ini_set()")]),t._v(" 控制当前应用生命周期内是否输出错误信息。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("On, 1")]),t._v(" 表示输出")]),t._v(" "),s("li",[s("code",[t._v("Off, 0")]),t._v(" 表示不输出")])]),t._v(" "),s("h4",{attrs:{id:"_1-3-3-是否记录日志-日志记录在哪"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-是否记录日志-日志记录在哪"}},[t._v("#")]),t._v(" 1.3.3 是否记录日志，日志记录在哪？")]),t._v(" "),s("p",[t._v("是否将错误日志（不可控的部分生成的）记录到日志文件，如果是那么记录到哪？"),s("br"),t._v("\n通过 "),s("code",[t._v("log_errors")]),t._v(" 配置项决定是否记录日志文件")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("On, 1")]),t._v(" 表示需要记录日志")]),t._v(" "),s("li",[s("code",[t._v("Off, 0")]),t._v(" 表示不需要")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("虽然记录日志也可以通过 "),s("code",[t._v("ini_set()")]),t._v(" 来控制，但是这个功能，原则上应该、必须做成统一的，并且强烈建议需要记录日志。"),s("br"),t._v("\n因此针对这个功能，只做配置项配置，并且需要记录日志： "),s("code",[t._v("log_errors = On")]),t._v("。")])]),t._v(" "),s("p",[t._v("通过 "),s("code",[t._v("error_log")]),t._v(" 配置项全局配置记录错误日志的文件")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("syslog")]),t._v("，默认")]),t._v(" "),s("li",[s("code",[t._v("php_errors.log")]),t._v("，可选")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("这个配置项的值不太好理解，这 "),s("code",[t._v("syslog")]),t._v(" 或者 "),s("code",[t._v("php_errors.log")]),t._v(" 到底在哪也没有明确说明，因此一般都“注释掉这个配置”。"),s("br"),t._v("\n注意，一旦注释，并且开始了“需要记录日志”，那么错误日志最终会“存储到服务器的错误日志中”。")])]),t._v(" "),s("p",[t._v("在服务器配置的 "),s("code",[t._v("vhost/xxx.conf")]),t._v(" 中，会有类似的配置："),s("code",[t._v("error_log xxx.log")]),t._v("，这个文件就是最终记录错误日志的地方。")]),t._v(" "),s("h3",{attrs:{id:"_1-4-错误应用示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-错误应用示例"}},[t._v("#")]),t._v(" 1.4 错误应用示例")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# php.ini 配置")]),t._v("\ndisplay_errors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Off\nerror_reporting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" E_ALL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ~E_DEPRECATED "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ~E_STRICT\nlog_errors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" On\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("error_log "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" syslog\n")])])]),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ENVIRONMENT 常量表示环境 development表示开发环境， 否则为线上环境")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'development'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ENVIRONMENT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ini_set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'display_errors'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error_reporting")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ini_set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'display_errors'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error_reporting")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("E_ALL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("E_NOTICE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("E_DEPRECATED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("E_STRICT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("E_USER_NOTICE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("E_USER_DEPRECATED")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当编写如下代码时（不管是开发环境，还是线上环境）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'hello world'")]),t._v("\n")])])]),s("p",[t._v("解析：因为是编译错误，所以会按照配置来控制、处理错误")]),t._v(" "),s("ul",[s("li",[t._v("控制：编译错误会报错")]),t._v(" "),s("li",[t._v("处理：\n"),s("ul",[s("li",[t._v("不会输出错误信息")]),t._v(" "),s("li",[t._v("会记录错误日志，但是会记录到服务器错误日志文件中"),s("br"),t._v("\n客户端看不到错误信息，但是应用被终止了\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-09_10-07-06.png",alt:""}}),t._v("\n但是服务器错误日志中记录了错误日志信息\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-09_10-09-56.png",alt:""}})])])])]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开发环境")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用未定义的函数")]),t._v("\n")])])]),s("p",[t._v("解析：是运行时错误，会按照上述设置的控制、处理错误：")]),t._v(" "),s("ul",[s("li",[t._v("控制：对所有错误都报错")]),t._v(" "),s("li",[t._v("处理：\n"),s("ul",[s("li",[t._v("会输出错误信息")]),t._v(" "),s("li",[t._v("日志记录还是按照配置处理"),s("br"),t._v("\n客户端看到了错误信息，但是应用被终止了\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-09_10-13-00.png",alt:""}}),t._v("\n同时服务器错误日志中也记录了错误日志信息\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-09_10-13-39.png",alt:""}})])])])]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 线上环境")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用未定义的函数")]),t._v("\n")])])]),s("p",[t._v("解析：是运行时错误，会按照上述设置的控制、处理错误：")]),t._v(" "),s("ul",[s("li",[t._v("控制：调用未定义的函数属于运行时致命错误 "),s("code",[t._v("E_ERROR")]),t._v("，在设置范围，会报错")]),t._v(" "),s("li",[t._v("处理：\n"),s("ul",[s("li",[t._v("不会输出错误信息")]),t._v(" "),s("li",[t._v("日志记录还是按照配置处理"),s("br"),t._v("\n客户端看不到错误信息，但是应用被终止了\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-09_10-16-19.png",alt:""}}),t._v("\n同时服务器错误日志中也记录了错误日志信息\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-09_10-17-03.png",alt:""}})])])])]),t._v(" "),s("h2",{attrs:{id:"_2-异常"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-异常"}},[t._v("#")]),t._v(" 2. 异常")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[s("code",[t._v("PHP5")]),t._v(" 中的异常，严格的说是不完整、不严谨的。"),s("br"),t._v("\n它将错误、异常区分处理，错误有内置的处理方式但是无法捕获，而异常没有内置处理方式却能捕获，但是却需要手动抛出才能捕获。"),s("br"),t._v("\n从 "),s("code",[t._v("PHP7")]),t._v(" 开始，异常和错误被当作一个模块，错会也会被当作“错误异常”能够被捕获。")])]),t._v(" "),s("p",[t._v("所谓“异常”，指用户触发的，可预见的逻辑错误，需要手动抛出异常，并且必须捕获异常。"),s("br"),t._v("\n关于 "),s("code",[t._v("PHP5")]),t._v(" 中的异常，需要学习：")]),t._v(" "),s("ul",[s("li",[t._v("异常结构")]),t._v(" "),s("li",[t._v("抛出异常对象")]),t._v(" "),s("li",[t._v("异常对象、"),s("code",[t._v("SPL 异常对象")]),t._v("、自定义异常对象")]),t._v(" "),s("li",[t._v("捕获异常对象")]),t._v(" "),s("li",[t._v("终止情况、返回情况")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("接下来的示例中，默认在 "),s("code",[t._v("php.ini")]),t._v(" 中配置：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("display_errors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" On\nerror_reporting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" E_ALL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ~E_DEPRECATED "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ~E_STRICT\nlog_errors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" On\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("error_log "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" syslog\n")])])])]),t._v(" "),s("h3",{attrs:{id:"_2-1-异常结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-异常结构"}},[t._v("#")]),t._v(" 2.1 异常结构")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这是一个完整的最基础的异常结构。"),s("br"),t._v(" "),s("code",[t._v("try")]),t._v(" 代码块中，可预见的能够抛出异常对象，通过 "),s("code",[t._v("throw new 异常对象")]),t._v(" 抛出。"),s("br"),t._v(" "),s("code",[t._v("catch")]),t._v(" 代码块中，参数部分捕获抛出的异常对象，内部处理异常信息。并且这里内部也可以再抛出异常对象。"),s("br"),t._v(" "),s("code",[t._v("finally")]),t._v("可选的，可以理解为一个“兜底”，不太常用，一般不使用。"),s("br"),t._v("\n接下来着重关注 "),s("code",[t._v("try ... catch ...")]),t._v("。"),s("br"),t._v(" "),s("strong",[t._v("异常抛出、捕获原理：")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("try")]),t._v(" 中，可预见的抛出异常对象，可以抛出多个异常对象，一旦抛出异常对象，"),s("code",[t._v("try")]),t._v(" 中后续的代码将终止执行")]),t._v(" "),s("li",[t._v("然后从抛出对象所在作用域查找捕获操作，并且会“冒泡查找”，直到匹配到对应异常对象被捕获的操作，则执行捕获；如果没有找到，会报致命错误")]),t._v(" "),s("li",[t._v("所以，"),s("code",[t._v("catch")]),t._v(" 可以有多个，但是必须最少有一个能够捕获 "),s("code",[t._v("try")]),t._v(" 中抛出的异常对象，一旦匹配则其他 "),s("code",[t._v("catch")]),t._v(" 将不会执行")]),t._v(" "),s("li",[s("code",[t._v("finally")]),t._v("作为兜底，不管是否匹配捕获操作，都会执行")])]),t._v(" "),s("h3",{attrs:{id:"_2-2-抛出异常对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-抛出异常对象"}},[t._v("#")]),t._v(" 2.2 抛出异常对象")]),t._v(" "),s("p",[t._v("上面提到了，在 "),s("code",[t._v("try")]),t._v(" 或者 "),s("code",[t._v("catch")]),t._v(" 中，均可以通过 "),s("code",[t._v("throw new 异常对象")]),t._v(" 抛出。"),s("br"),t._v("\n一旦抛出异常对象，"),s("code",[t._v("trh")]),t._v(" 或者 "),s("code",[t._v("catch")]),t._v(" 中后续的代码将不会执行。"),s("br"),t._v("\n一旦抛出异常对象，必须至少有一个捕获操作能够捕获异常对象，否则报“致命错误”。")]),t._v(" "),s("h3",{attrs:{id:"_2-3-异常对象、spl-异常对象、自定义异常对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-异常对象、spl-异常对象、自定义异常对象"}},[t._v("#")]),t._v(" 2.3 异常对象、"),s("code",[t._v("SPL 异常对象")]),t._v("、自定义异常对象")]),t._v(" "),s("p",[t._v("抛出的异常对象，必须是内置异常对象的继承对象。"),s("br"),t._v("\n内置的异常对象为 "),s("code",[t._v("Exception")]),t._v("，它实现了 "),s("code",[t._v("Throwable")]),t._v(" 接口。"),s("br"),t._v("\n关注 "),s("code",[t._v("Exception")]),t._v(" 内置的基础异常对象：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 没有列出来的属性或方法，都是私有的或者不能重写的，不用关注")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Throwable")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 属性 */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword type-declaration"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$message")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 方法 */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__tostring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword return-type"}},[t._v("string")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword return-type"}},[t._v("string")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword return-type"}},[t._v("int")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword return-type"}},[t._v("string")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword return-type"}},[t._v("int")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword return-type"}},[t._v("array")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("基础异常类，封装好了获取异常信息的基础操作，其中 "),s("code",[t._v("$message")]),t._v(" 是可以重写的异常描述，"),s("code",[t._v("getMessage()")]),t._v("是获取异常描述的方法。"),s("br"),t._v("\n那么可以通过继承来扩展基础异常类，实现更多更加明确的异常，比如：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("MissingArgumentsException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'缺少参数'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("InvalidArgumentException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'参数不合法'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MissingArgumentsException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InvalidArgumentException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("MissingArgumentsException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("InvalidArgumentException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("基于这个基础异常类，在 "),s("code",[t._v("SPL")]),t._v("（"),s("code",[t._v("PHP")]),t._v(" 标准类库）中，已经内置了一些异常类（"),s("code",[t._v("PHP")]),t._v(" 标准类库 "),s("code",[t._v("SPL")]),t._v(" 是内置的，可以直接使用）。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("LogicException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("                      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 逻辑异常")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("BadFunctionCallException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogicException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 逻辑异常下更加明细的异常类")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("BadMethodCallException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BadFunctionCallException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("DomainException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogicException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("InvalidArgumentException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogicException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("LengthException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogicException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("OutOfRangeException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogicException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("RuntimeException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("                   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 运行时异常")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("OutOfBoundsException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 运行时异常下更加明细的异常类")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("OverflowException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("RangeException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("UnderflowException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("UnexpectedValueException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其实，就算是 "),s("code",[t._v("SPL 异常")]),t._v("，也是基于基础异常类 "),s("code",[t._v("Exception")]),t._v(" 继承来扩展的，而扩展的原则，从基础异常类的结构也能够看到：")]),t._v(" "),s("ul",[s("li",[t._v("可以修改 "),s("code",[t._v("$message")]),t._v("，异常描述")]),t._v(" "),s("li",[t._v("可以自定义 "),s("code",[t._v("__toString()")]),t._v("，当直接输出对象时调用"),s("br"),t._v("\n除此以外，其他的都不能修改，那么得到如下示例：")])]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("MyTestException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$message")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'测试异常类'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("echoMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"异常描述：'),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' \\t"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("echoFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"异常文件：'),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' \\t"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("echoLine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"异常行数：'),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' \\t"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("__toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("echoMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("echoFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("echoLine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("MyTestException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("MyTestException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("得到如下的测试图例：\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-10_08-36-29.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"_2-4-捕获异常对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-捕获异常对象"}},[t._v("#")]),t._v(" 2.4 捕获异常对象")]),t._v(" "),s("p",[t._v("捕获可以有多个，但是最少要有一个能够匹配当前抛出的异常对象，否则报“致命错误”。"),s("br"),t._v("\n并且在捕获代码块中，还可以抛出异常对象，同上，如果这里的异常被抛出，那么该捕获之后，必须至少存在一个能够匹配这里抛出的异常对象。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("BException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("CException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-5-终止情况、返回情况"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-终止情况、返回情况"}},[t._v("#")]),t._v(" 2.5 终止情况、返回情况")]),t._v(" "),s("p",[s("strong",[t._v("终止：")]),s("br"),t._v("\n在任何抛出异常的作用域块中，一旦抛出将被终止，后续代码将不会执行，而是转到 "),s("code",[t._v("finally")]),t._v(" 或者 "),s("code",[t._v("catch")]),t._v(" 部分执行；并且，"),s("code",[t._v("catch")]),t._v(" 或 "),s("code",[t._v("finally")]),t._v(" 最终执行完成后（没有手动的终止脚本）， "),s("code",[t._v("try ... catch")]),t._v(" 后续代码继续执行。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("MyTestException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("MyTestException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'down'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("上面示例中，最后加了一个输出 "),s("code",[t._v("down")]),t._v("，看图示结果：\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-10_08-46-15.png",alt:""}})]),t._v(" "),s("p",[s("strong",[t._v("返回：")]),s("br"),t._v("\n这个要涉及到 "),s("code",[t._v("finally")]),t._v("。"),s("br"),t._v("\n如果在 "),s("code",[t._v("try")]),t._v(" 或者 "),s("code",[t._v("catch")]),t._v(" 中执行 "),s("code",[t._v("return")]),t._v("，"),s("code",[t._v("finally")]),t._v(" 中的代码任然会执行，并且会先执行 "),s("code",[t._v("finally")]),t._v(" 中的代码，再执行 "),s("code",[t._v("try")]),t._v("或 "),s("code",[t._v("catch")]),t._v(" 中的 "),s("code",[t._v("return")]),t._v("；但是，如果 "),s("code",[t._v("finally")]),t._v(" 中也有 "),s("code",[t._v("return")]),t._v("，那么先执行 "),s("code",[t._v("finally")]),t._v(" 中的代码，但是暂时不返回，然后执行 "),s("code",[t._v("try")]),t._v(" 或者 "),s("code",[t._v("catch")]),t._v(" 中的代码，并且也不返回，等都执行完了，最终返回 "),s("code",[t._v("finally")]),t._v(" 中的 "),s("code",[t._v("return")]),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"_3-终止"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-终止"}},[t._v("#")]),t._v(" 3. 终止")]),t._v(" "),s("p",[t._v("手动终止（"),s("code",[t._v("exit")]),t._v("、"),s("code",[t._v("die")]),t._v("），正常终止（执行完成）都是终止，非正常终止（致命错误）。\n在终止时，"),s("code",[t._v("PHP")]),t._v(" 提供了一个钩子，用于在终止时做处理，也因为这个功能，实现了接下来的自定义错误、异常。")]),t._v(" "),s("h2",{attrs:{id:"_4-自定义错误、异常"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-自定义错误、异常"}},[t._v("#")]),t._v(" 4. 自定义错误、异常")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("原理")]),t._v(" "),s("p",[t._v("从上面的学习直到，关于错误，我们只能控制输出、报错，很多错误（除了用户自定义的）的触发都是内置的，我们控制不了，但是异常是我们能够完全控制的，那么，针对应用中的所有错误、异常，我需要统一管理怎么做？"),s("br"),t._v("\n那就是将错误触发，也转换为异常，最终全部被异常捕获。")])]),t._v(" "),s("h3",{attrs:{id:"_4-1-设置自定义错误处理程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-设置自定义错误处理程序"}},[t._v("#")]),t._v(" 4.1 设置自定义错误处理程序")]),t._v(" "),s("p",[t._v("通过 "),s("code",[t._v("set_error_handler(callable $callback, $error_levels = E_ALL)")]),t._v("设置回调函数作为自定义错误处理程序。"),s("br"),t._v(" "),s("strong",[s("code",[t._v("$error_levels = E_ALL")])]),s("br"),t._v("\n这个参数，控制了“哪些错误，会被自定义错误处理程序处理”，默认所有错误都交由自定义错误处理。")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("特殊情况，当自定义错误处理函数 "),s("code",[t._v("return false")]),t._v("，返回 "),s("code",[t._v("false")]),t._v("时，错误处理会冒泡到 “内置错误处理程序处理”。")])]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("当设置了自定义错误处理程序，"),s("code",[t._v("error_reproting()")]),t._v(" 设置将失效，也就是说此时开始报错级别将使用 "),s("code",[t._v("set_error_handler()")]),t._v(" 的第二个参数指定的错误级别。"),s("br"),t._v("\n但是，之前通过 "),s("code",[t._v("error_reproting()")]),t._v(" 设置的值，还是可以通过该函数获取（只是设置不会生效）。")])]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("特殊的，"),s("code",[t._v("E_ERROR, E_PARSE, E_CORE_ERROR, E_CORE_WARNING, E_COMPILE_ERROR, E_COMPILE_WARNING")]),t._v("，这些错误级别，不能由自定义错误处理程序处理。")])]),t._v(" "),s("p",[t._v("那么这就有问题了，既然是自定义错误处理，目的就是想完全控制错误，但是设置了 "),s("code",[t._v("E_ALL")]),t._v(" 为第二个参数，居然还有这么多错误无法处理，还有什么意义呢？"),s("br"),t._v("\n其实，如果仔细观察会发现，上述不能处理的错误，除了 "),s("code",[t._v("E_ERROR")]),t._v(" 以外其他的都是“初始化错误”，“编译错误”，而我们设置自定义错误处理程序是在运行时阶段的，必然不能控制那些之前就会触发的错误，显然正确的。"),s("br"),t._v("\n至于 "),s("code",[t._v("E_ERROR")]),t._v("，其实如果稍微去了解下这个错误就会发现，它包含了很多情况，有的情况是系统问题导致的致命错误，这显然也是程序无法控制的，因此对于这种可能控制、可能控制不了的错误显然也不应该囊括。")]),t._v(" "),s("p",[t._v("那么继续，既然这些错误处理不了，那到底如何实现真的自定义处理错误？"),s("br"),t._v("\n答：这就需要下面的注册终止处理程序了。仔细看上面那些不能处理的错误，除了两个警告以外，其他的都是致命错误，会导致程应用终止，那么从最大限度的自定义控制的话，如果能在应用终止的时候做处理，也变相的处理了那些错误。"),s("br"),t._v("\n现在先来看能处理的情况下，自定义错误处理程序的要求：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errno")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必须，错误码")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errstr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必须，错误描述")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errfile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可选，错误文件")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errline")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可选，错误行数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errcontext")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可选，错误上下文")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("也就是说，那些能够被自定义错误处理程序控制的错误发生时，会回调这个程序，并且传入对应的五个参数，然后我们自定义错误处理程序拿到这些参数做处理。比如：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("my_error_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errno")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errstr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errfile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errline")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"错误代码：'),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errno")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("\\t 错误信息："),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errstr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("\\t 错误文件："),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errfile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("\\t 错误行数："),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errline")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_error_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'my_error_handler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("trigger_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'测试'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("E_USER_ERROR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("得到如下图示结果：\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-10_10-19-33.png",alt:""}}),t._v("\n显然，我们已经实现了自定控制错误（允许范围内的错误）。")]),t._v(" "),s("h3",{attrs:{id:"_4-2-注册终止处理程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-注册终止处理程序"}},[t._v("#")]),t._v(" 4.2 注册终止处理程序")]),t._v(" "),s("p",[t._v("通过 "),s("code",[t._v("register_shutdown_function(callable $callback, ...$args)")]),t._v(" 注册终止处理程序。"),s("br"),t._v("\n上面说过终止有手动的 "),s("code",[t._v("exit")]),t._v(" 或 "),s("code",[t._v("die")]),t._v("终止，以及程序执行完毕，和致命错误导致的终止。"),s("br"),t._v("\n也就是说，注册的终止处理程序，在遇到上述情况时，会自动调用回调处理。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("my_shutdown_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'Script shutdown!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("register_shutdown_function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'my_shutdown_handler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// test();         调用未定义的函数")]),t._v("\n")])])]),s("p",[t._v("直接运行上述示例，就会得到图示结果：\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-10_10-27-15.png",alt:""}})]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("自定义终止处理程序，是在运行时阶段设置的，那么同样“初始化错误”，“编译错误”，定义之前的错误导致的终止，肯定也不能被注册的自定义处理程序管理的。")])]),t._v(" "),s("p",[t._v("咦，既然这些错误还是不能被注册的自定义终止程序处理，那么到底该怎么真的自定义控制绝大部分错误呢？"),s("br"),t._v("\n答：这里涉及一个内置函数 "),s("code",[t._v("error_get_last()")]),t._v("，它能够获取“最后发生的错误”。如果在注册的自定义终止执行完成之前，调用该函数获取错误，然后判断是否属于自定义错误处理程序不能控制的那些错误，如果属于再手动调用自定义的错误处理程序，那不就解决了自定义错误处理程序控制绝大部分错误了吗！！！"),s("br"),t._v("\n其实，这就是实现自定义错误控制的原理。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("my_shutdown_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error_get_last")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("isset")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_ERROR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_PARSE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_CORE_ERROR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_CORE_WARNING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_COMPILE_ERROR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_COMPILE_WARNING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 属于那些自定义错误处理程序 my_error_handler() 默认不能处理的错误")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("my_error_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'line'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 而其他的情况：正常执行完成，其他错误导致终止，exit、die 手动终止，都不会执行任何操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("以上，完美解决。（但却是，个别的错误任然没有办法处理，比如 "),s("code",[t._v("E_CORE_WARNING, E_COMPILE_WARNING")]),t._v(")")]),t._v(" "),s("h3",{attrs:{id:"_4-3-设置自定义异常处理程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-设置自定义异常处理程序"}},[t._v("#")]),t._v(" 4.3 设置自定义异常处理程序")]),t._v(" "),s("p",[t._v("好了，上述自定义错误处理、自定义终止处理都实现了绝大部分的错误处理，现在想要对错误进行控制就简单了，将那些控制的错误，以异常的形式抛出，然后捕获，不就实现了控制错误了吗！"),s("br"),t._v("\n不止如此，如果我还想对异常也同样的自定义控制的话，"),s("code",[t._v("PHP")]),t._v(" 也提供了自定义的方案。"),s("br"),t._v("\n通过 "),s("code",[t._v("set_exception_handler(callable $callback)")]),t._v(" 实现自定义异常处理。")]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("上面学习异常的时候，没有任何一个地方说过有内置的异常处理操作（错误有内置的处理），并且异常需要手动抛出，并且必须要捕获。")])]),t._v(" "),s("p",[t._v("而这个设置的自定义异常内置了操作，简化了异常的结构："),s("br"),t._v(" "),s("strong",[t._v("自定义异常处理，相当于把整个应用（从设置自定义异常处理程序开始）隐形的包括在了 "),s("code",[t._v("try")]),t._v(" 代码块中，并且我们设置自定义异常处理程序就相当于 "),s("code",[t._v("catch")]),t._v("。")]),s("br"),t._v("\n因此，一旦设置自定义异常处理程序，在后面的代码中，我们只需要抛出异常，然后不用显示的捕获了，其捕获操作就交给了设置的自定义异常处理程序。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("还记得上面学习异常的时候说过，所有的异常类都需要实现 "),s("code",[t._v("Throwable")]),t._v(" 接口，并且是 "),s("code",[t._v("Excepiton")]),t._v(" 的扩展类，因此，抛出的对象必须实现 "),s("code",[t._v("Throwable")]),t._v(" 接口，而这里的 "),s("code",[t._v("$e")]),t._v(" 就是捕获的异常对象。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("AException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("BException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("CException")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("如上示例的自定义异常类，它们都继承了基础异常类，同时也实现了 "),s("code",[t._v("Throwable")]),t._v(" 接口，那么如下简单示例实现捕获异常。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("my_exception_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'捕获异常：'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_exception_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'my_exception_handler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exception")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'测试'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("得到如下图示结果：\n"),s("img",{attrs:{src:"/asserts/php/Snipaste_2023-06-10_10-56-39.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"_4-4-自定义异常、错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-自定义异常、错误"}},[t._v("#")]),t._v(" 4.4 自定义异常、错误")]),t._v(" "),s("p",[t._v("通过上述三个知识点学习，结合起来实现控制绝大部分错误，并且将错误以异常形式抛出，并自动捕获统一处理所有异常。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("my_error_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errno")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errstr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errfile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$errline")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("xxx")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("my_shutdown_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error_get_last")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("isset")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_ERROR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_PARSE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_CORE_ERROR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_CORE_WARNING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_COMPILE_ERROR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("E_COMPILE_WARNING")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 属于那些自定义错误处理程序 my_error_handler() 默认不能处理的错误")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("my_error_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$last_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'line'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("my_exception_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_error_hanlder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'my_error_hanlder'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("register_shutdown_function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'my_shutdown_handler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_exception_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'my_exception_handler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);