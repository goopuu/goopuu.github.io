<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>框架核心文件 | GooPuu</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="技术、前端技术，整理技术文档">
    
    <link rel="preload" href="/assets/css/0.styles.5be624d7.css" as="style"><link rel="preload" href="/assets/js/app.a2be46e1.js" as="script"><link rel="preload" href="/assets/js/2.c4a55d75.js" as="script"><link rel="preload" href="/assets/js/59.2dd1e634.js" as="script"><link rel="prefetch" href="/assets/js/10.00d50cc6.js"><link rel="prefetch" href="/assets/js/11.116edcd9.js"><link rel="prefetch" href="/assets/js/12.8d813279.js"><link rel="prefetch" href="/assets/js/13.cf20dfe4.js"><link rel="prefetch" href="/assets/js/14.9240ee25.js"><link rel="prefetch" href="/assets/js/15.6f2e36ad.js"><link rel="prefetch" href="/assets/js/16.31963ec0.js"><link rel="prefetch" href="/assets/js/17.1a990a93.js"><link rel="prefetch" href="/assets/js/18.25649302.js"><link rel="prefetch" href="/assets/js/19.f501b2b3.js"><link rel="prefetch" href="/assets/js/20.d950bcb4.js"><link rel="prefetch" href="/assets/js/21.682698e1.js"><link rel="prefetch" href="/assets/js/22.21b445b2.js"><link rel="prefetch" href="/assets/js/23.d400bd60.js"><link rel="prefetch" href="/assets/js/24.2d52e7c6.js"><link rel="prefetch" href="/assets/js/25.b5c2bf83.js"><link rel="prefetch" href="/assets/js/26.9e575ce0.js"><link rel="prefetch" href="/assets/js/27.78bcdcb3.js"><link rel="prefetch" href="/assets/js/28.3d13414a.js"><link rel="prefetch" href="/assets/js/29.4c76408b.js"><link rel="prefetch" href="/assets/js/3.c6d7fc3c.js"><link rel="prefetch" href="/assets/js/30.72837135.js"><link rel="prefetch" href="/assets/js/31.ec3acd91.js"><link rel="prefetch" href="/assets/js/32.7ab63353.js"><link rel="prefetch" href="/assets/js/33.243ce462.js"><link rel="prefetch" href="/assets/js/34.cbed375d.js"><link rel="prefetch" href="/assets/js/35.f8989dec.js"><link rel="prefetch" href="/assets/js/36.8ba39ddf.js"><link rel="prefetch" href="/assets/js/37.dda1b25a.js"><link rel="prefetch" href="/assets/js/38.d25ba1f6.js"><link rel="prefetch" href="/assets/js/39.1ec1d519.js"><link rel="prefetch" href="/assets/js/4.2176f0d8.js"><link rel="prefetch" href="/assets/js/40.94973a05.js"><link rel="prefetch" href="/assets/js/41.e12f4c7d.js"><link rel="prefetch" href="/assets/js/42.46323141.js"><link rel="prefetch" href="/assets/js/43.711ab579.js"><link rel="prefetch" href="/assets/js/44.f645cc5a.js"><link rel="prefetch" href="/assets/js/45.73afa142.js"><link rel="prefetch" href="/assets/js/46.91a9b3ad.js"><link rel="prefetch" href="/assets/js/47.9a2a9d74.js"><link rel="prefetch" href="/assets/js/48.737f52e3.js"><link rel="prefetch" href="/assets/js/49.ecab2c21.js"><link rel="prefetch" href="/assets/js/5.91c18d5d.js"><link rel="prefetch" href="/assets/js/50.24ce14d6.js"><link rel="prefetch" href="/assets/js/51.5abcf9b3.js"><link rel="prefetch" href="/assets/js/52.69567ee5.js"><link rel="prefetch" href="/assets/js/53.1f658822.js"><link rel="prefetch" href="/assets/js/54.c690ae41.js"><link rel="prefetch" href="/assets/js/55.4eb95d0d.js"><link rel="prefetch" href="/assets/js/56.8c782afd.js"><link rel="prefetch" href="/assets/js/57.206d39f5.js"><link rel="prefetch" href="/assets/js/58.92f0ff0c.js"><link rel="prefetch" href="/assets/js/6.537e369f.js"><link rel="prefetch" href="/assets/js/60.53f4090e.js"><link rel="prefetch" href="/assets/js/61.6c93bf75.js"><link rel="prefetch" href="/assets/js/62.735d9878.js"><link rel="prefetch" href="/assets/js/63.ccb65206.js"><link rel="prefetch" href="/assets/js/64.5fe06553.js"><link rel="prefetch" href="/assets/js/65.f65b3817.js"><link rel="prefetch" href="/assets/js/66.633ff33c.js"><link rel="prefetch" href="/assets/js/67.b7812b8c.js"><link rel="prefetch" href="/assets/js/68.910f070e.js"><link rel="prefetch" href="/assets/js/69.f0a0f76d.js"><link rel="prefetch" href="/assets/js/7.f36c84d3.js"><link rel="prefetch" href="/assets/js/70.c2294a03.js"><link rel="prefetch" href="/assets/js/71.3c572e74.js"><link rel="prefetch" href="/assets/js/72.c8089ef4.js"><link rel="prefetch" href="/assets/js/73.2e863aa4.js"><link rel="prefetch" href="/assets/js/74.95087ea4.js"><link rel="prefetch" href="/assets/js/8.b0d0596a.js"><link rel="prefetch" href="/assets/js/9.6c11348f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5be624d7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">GooPuu</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          语法基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html/basic.html" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/css/basic.html" class="nav-link">
  CSS
</a></li><li class="dropdown-subitem"><a href="/javascript/basic.html" class="nav-link">
  JavaScript
</a></li></ul></li><li class="dropdown-item"><h4>
          基础提升
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html/promote.html" class="nav-link">
  HTML 中的关注点
</a></li><li class="dropdown-subitem"><a href="/css/promote.html" class="nav-link">
  CSS 酷炫特效
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/front-end-project.html" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/git/introduce.html" class="nav-link">
  GIT
</a></div><div class="nav-item"><a href="/npm.html" class="nav-link">
  NPM
</a></div><div class="nav-item"><a href="/webpack/introduce.html" class="nav-link">
  Webpack
</a></div><div class="nav-item"><a href="/sass.html" class="nav-link">
  Sass
</a></div><div class="nav-item"><a href="/vue.html" class="nav-link">
  Vue2
</a></div><div class="nav-item"><a href="/uniapp.html" class="nav-link">
  uniapp
</a></div><div class="nav-item"><a href="/ssr.html" class="nav-link">
  SSR
</a></div><div class="nav-item"><a href="/serverless.html" class="nav-link">
  ServerLess
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="PHP" class="dropdown-title"><span class="title">PHP</span> <span class="arrow down"></span></button> <button type="button" aria-label="PHP" class="mobile-dropdown-title"><span class="title">PHP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/php/php/anonymous-func-closure.html" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/php/ci3/entrance.html" class="nav-link">
  CodeIgnier3
</a></li><li class="dropdown-item"><!----> <a href="/php/laravel8/index.html" class="nav-link">
  Laravel8
</a></li></ul></div></div><div class="nav-item"><a href="/nginx.html" class="nav-link">
  Nginx
</a></div><div class="nav-item"><a href="/mysql.html" class="nav-link">
  MySQL
</a></div><div class="nav-item"><a href="/linux.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/docker.html" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/opensource.html" class="nav-link">
  开源项目
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          语法基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html/basic.html" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/css/basic.html" class="nav-link">
  CSS
</a></li><li class="dropdown-subitem"><a href="/javascript/basic.html" class="nav-link">
  JavaScript
</a></li></ul></li><li class="dropdown-item"><h4>
          基础提升
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html/promote.html" class="nav-link">
  HTML 中的关注点
</a></li><li class="dropdown-subitem"><a href="/css/promote.html" class="nav-link">
  CSS 酷炫特效
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/front-end-project.html" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/git/introduce.html" class="nav-link">
  GIT
</a></div><div class="nav-item"><a href="/npm.html" class="nav-link">
  NPM
</a></div><div class="nav-item"><a href="/webpack/introduce.html" class="nav-link">
  Webpack
</a></div><div class="nav-item"><a href="/sass.html" class="nav-link">
  Sass
</a></div><div class="nav-item"><a href="/vue.html" class="nav-link">
  Vue2
</a></div><div class="nav-item"><a href="/uniapp.html" class="nav-link">
  uniapp
</a></div><div class="nav-item"><a href="/ssr.html" class="nav-link">
  SSR
</a></div><div class="nav-item"><a href="/serverless.html" class="nav-link">
  ServerLess
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="PHP" class="dropdown-title"><span class="title">PHP</span> <span class="arrow down"></span></button> <button type="button" aria-label="PHP" class="mobile-dropdown-title"><span class="title">PHP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/php/php/anonymous-func-closure.html" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/php/ci3/entrance.html" class="nav-link">
  CodeIgnier3
</a></li><li class="dropdown-item"><!----> <a href="/php/laravel8/index.html" class="nav-link">
  Laravel8
</a></li></ul></div></div><div class="nav-item"><a href="/nginx.html" class="nav-link">
  Nginx
</a></div><div class="nav-item"><a href="/mysql.html" class="nav-link">
  MySQL
</a></div><div class="nav-item"><a href="/linux.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/docker.html" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/opensource.html" class="nav-link">
  开源项目
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  关于我
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GIT</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NPM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Sass</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue2.x</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>uniapp</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SSR</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ServeLess</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PHP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>CodeIgniter3</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/php/ci3/entrance.html" class="sidebar-link">入口</a></li><li><a href="/php/ci3/core.html" aria-current="page" class="active sidebar-link">框架核心文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_1-核心文件" class="sidebar-link">1. 核心文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_1-1-核心文件位置" class="sidebar-link">1.1 核心文件位置</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_1-2-核心文件的作用" class="sidebar-link">1.2 核心文件的作用</a></li></ul></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-核心功能" class="sidebar-link">2. 核心功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-1-定义版本号" class="sidebar-link">2.1 定义版本号</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-2-加载配置常量" class="sidebar-link">2.2 加载配置常量</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-3-加载系统函数库" class="sidebar-link">2.3 加载系统函数库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-4-自定义异常错误处理" class="sidebar-link">2.4 自定义异常错误处理</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-5-composer-处理" class="sidebar-link">2.5 composer 处理</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-6-加载类库-load-class-函数" class="sidebar-link">2.6 加载类库 load_class()函数</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-7-基准测试类库" class="sidebar-link">2.7 基准测试类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-8-钩子类库" class="sidebar-link">2.8 钩子类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-9-配置类库" class="sidebar-link">2.9 配置类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-10-加载附加函数库" class="sidebar-link">2.10 加载附加函数库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-11-编码类库" class="sidebar-link">2.11 编码类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-12-请求地址类库" class="sidebar-link">2.12 请求地址类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-13-路由类库" class="sidebar-link">2.13 路由类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-14-输出类库" class="sidebar-link">2.14 输出类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-15-安全处理类库" class="sidebar-link">2.15 安全处理类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-16-输入类库" class="sidebar-link">2.16 输入类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-17-语言类库" class="sidebar-link">2.17 语言类库</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-18-载入基础控制器" class="sidebar-link">2.18 载入基础控制器</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-19-定义函数-引用整个-ci-系统" class="sidebar-link">2.19 定义函数，引用整个 CI 系统</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-20-载入扩展基础控制器" class="sidebar-link">2.20 载入扩展基础控制器</a></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_2-21-路由分发" class="sidebar-link">2.21 路由分发</a></li></ul></li><li class="sidebar-sub-header"><a href="/php/ci3/core.html#_3-综述" class="sidebar-link">3. 综述</a></li></ul></li><li><a href="/php/ci3/custom_exception_error.html" class="sidebar-link">自定义异常错误处理</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-核心文件"><a href="#_1-核心文件" class="header-anchor">#</a> 1. 核心文件</h2> <h3 id="_1-1-核心文件位置"><a href="#_1-1-核心文件位置" class="header-anchor">#</a> 1.1 核心文件位置</h3> <p><code>BASEPATH . 'core/CodeIgniter.php'</code>。</p> <blockquote><p>上一节说过全局目录常量 <code>BASEPATH</code> 表示 <code>xxx/system/</code>这个路径，因此核心文件就位于 <code>xxx/system/core/CodeIgniter.php</code>。</p></blockquote> <h3 id="_1-2-核心文件的作用"><a href="#_1-2-核心文件的作用" class="header-anchor">#</a> 1.2 核心文件的作用</h3> <p>所谓核心文件，就是整个框架启动、应用依赖、路由分发、核心功能等等，所有运行应用最最基础和最最核心的功能都需要在这里实现。<br>
其他的扩展、开发，最终就是基于核心文件中支持的功能来实现的。</p> <h2 id="_2-核心功能"><a href="#_2-核心功能" class="header-anchor">#</a> 2. 核心功能</h2> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>如下的核心功能，大部分都会单独做章节学习。</p></div> <h3 id="_2-1-定义版本号"><a href="#_2-1-定义版本号" class="header-anchor">#</a> 2.1 定义版本号</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'CI_VERSION'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'xxx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-2-加载配置常量"><a href="#_2-2-加载配置常量" class="header-anchor">#</a> 2.2 加载配置常量</h3> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>这里又要涉及 <code>PHP</code> 的一个知识点：“常量一旦定义，就无法修改或重复定义”，那么加载的常量如果在后面的配置文件中重复定义或修改，则是不生效的，开发环境会报错，其他环境不会（见第一节环境限制错误处理）</p></div> <p><strong>常量配置文件加载规则：</strong><br>
既然常量不能复写和重定义，那么先加载的常量生效，后面加载的重复的则不生效。那么框架源码中是如下加载顺序：</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">APPPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'config/'</span> <span class="token operator">.</span> <span class="token constant">ENVIRONMENT</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/constants.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token constant">APPPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'config/'</span> <span class="token operator">.</span> <span class="token constant">ENVIRONMENT</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/constants.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token constant">APPPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'config/constants.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以得到以下结论：</p> <ul><li>常量配置文件名为 <code>constants.php</code></li> <li>常量配置文件位于：
<ul><li>环境级别常量配置：<code>APPPTH . 'config/' . ENVIRONMENT . 'constants.php'</code></li> <li>系统级别常量配置：<code>APPPTH . 'config/constants.php'</code></li></ul></li> <li>常量配置的优先级：环境级别常量 &gt; 系统级别常量</li></ul> <p><em>不是说只能以上述方式定义常量，而是说“默认的”会以上述方式定义；当然我可以随便定义一个位置，随便创建一个文件，在其中定义常量，然后在应用中手动加载。</em></p> <h3 id="_2-3-加载系统函数库"><a href="#_2-3-加载系统函数库" class="header-anchor">#</a> 2.3 加载系统函数库</h3> <p>所谓函数库，就是一些函数都声明在一个文件中，就是一个工具库而已。框架默认编写了一些功能函数，并在这里加载，则从这里开始之后任何地方都可以随意调用这些函数。<br>
系统函数库位于：<code>BASEPATH. 'core/Common.php'</code>。
<em>会序也会有扩展、新增函数库的方法。</em></p> <h3 id="_2-4-自定义异常错误处理"><a href="#_2-4-自定义异常错误处理" class="header-anchor">#</a> 2.4 自定义异常错误处理</h3> <p>会有专门的章节学习，见<a href="/php/ci3/custom_exception_error">自定义异常错误处理</a>。</p> <h3 id="_2-5-composer-处理"><a href="#_2-5-composer-处理" class="header-anchor">#</a> 2.5 <code>composer</code> 处理</h3> <p>会有专门的章节学习，见<a href="/php/ci3/composer">composer自动加载</a>。</p> <h3 id="_2-6-加载类库-load-class-函数"><a href="#_2-6-加载类库-load-class-函数" class="header-anchor">#</a> 2.6 加载类库 <code>load_class()</code>函数</h3> <p>会有专门的章节学习，见<a href="/php/ci3/loader">加载类库</a>。</p> <h3 id="_2-7-基准测试类库"><a href="#_2-7-基准测试类库" class="header-anchor">#</a> 2.7 基准测试类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/benchmark_lib">基准测试类库</a>。</p> <h3 id="_2-8-钩子类库"><a href="#_2-8-钩子类库" class="header-anchor">#</a> 2.8 钩子类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/hook_lib">钩子类库</a>。</p> <h3 id="_2-9-配置类库"><a href="#_2-9-配置类库" class="header-anchor">#</a> 2.9 配置类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/config_lib">配置类库</a>。</p> <h3 id="_2-10-加载附加函数库"><a href="#_2-10-加载附加函数库" class="header-anchor">#</a> 2.10 加载附加函数库</h3> <p>这部分的函数库，是专门用来处理特殊的情况的，和上述的系统函数库其实一样，都是函数库，都加载了。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token constant">BASEPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'core/compat/mbstring.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token constant">BASEPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'core/compat/hash.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token constant">BASEPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'core/compat/password.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token constant">BASEPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'core/compat/standard.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><em>适当了解其中的函数，以后如果遇到可以使用的场景可直接使用，或者参考后自己编写功能函数。</em></p> <h3 id="_2-11-编码类库"><a href="#_2-11-编码类库" class="header-anchor">#</a> 2.11 编码类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/utf8_lib">编码类库</a>。</p> <h3 id="_2-12-请求地址类库"><a href="#_2-12-请求地址类库" class="header-anchor">#</a> 2.12 请求地址类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/uri_lib">请求地址类库</a>。</p> <h3 id="_2-13-路由类库"><a href="#_2-13-路由类库" class="header-anchor">#</a> 2.13 路由类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/router_lib">路由类库</a>。</p> <h3 id="_2-14-输出类库"><a href="#_2-14-输出类库" class="header-anchor">#</a> 2.14 输出类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/output_lib">输出类库</a>。</p> <h3 id="_2-15-安全处理类库"><a href="#_2-15-安全处理类库" class="header-anchor">#</a> 2.15 安全处理类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/security_lib">安全处理类库</a>。</p> <h3 id="_2-16-输入类库"><a href="#_2-16-输入类库" class="header-anchor">#</a> 2.16 输入类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/input_lib">输入类库</a>。</p> <h3 id="_2-17-语言类库"><a href="#_2-17-语言类库" class="header-anchor">#</a> 2.17 语言类库</h3> <p>会有专门的章节学习，见<a href="/php/ci3/lang_lib">语言类库</a>。</p> <h3 id="_2-18-载入基础控制器"><a href="#_2-18-载入基础控制器" class="header-anchor">#</a> 2.18 载入基础控制器</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">require_once</span> <span class="token constant">BASEPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'core/Controller.php'</span><span class="token punctuation">;</span>
</code></pre></div><p>这个控制器，应该是所有开发中控制器的最最顶层的基础类库，后面在 <a href="/php/ci3/controller">控制器</a>中专门学习。</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>如果遇到这样的场景，我的项目中有不同的业务场景，比如一种是需要自有系统用户认证的，还有一种是其他平台用户认证的，显然这个时候应该有两种基础类库供对应控制器继承，（这里提前说）如果根据框架提供的扩展基础控制器、复写基础控制器，这样也只能实现一种平台的基础控制器，另一种还是无法实现。<br>
因此可以参考这里的源码方式，修改源码，在这里新增载入一个自定义的基础控制器，有更多的上述情况同理。</p></div> <h3 id="_2-19-定义函数-引用整个-ci-系统"><a href="#_2-19-定义函数-引用整个-ci-系统" class="header-anchor">#</a> 2.19 定义函数，引用整个 <code>CI</code> 系统</h3> <p>这样的场景，我们些了一个自定义的类库，它并不继承基础控制器，但是在其中，需要使用 <code>CI</code> 的功能，比如数据库操作，比如加载类库等等，此时就需要一个方式来引用整个 <code>CI</code> 系统。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">function</span> <span class="token operator">&amp;</span><span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name static-context">CI_Controller</span><span class="token operator">::</span><span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>记得上一步“载入基础控制器”吗，那里载入的控制器名称就是 <code>CI_Controller</code>，并且其中有一个方法 <code>get_instance()</code>。如此，在其他任何与 <code>CI</code> 没有关联的地方，都可以：</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$ci</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$ci</span><span class="token operator">-&gt;</span><span class="token property">load</span><span class="token operator">-&gt;</span><span class="token function">model</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$ci</span><span class="token operator">-&gt;</span><span class="token property">db</span><span class="token operator">-&gt;</span><span class="token function">trans_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
</code></pre></div><h3 id="_2-20-载入扩展基础控制器"><a href="#_2-20-载入扩展基础控制器" class="header-anchor">#</a> 2.20 载入扩展基础控制器</h3> <p>上面载入的基础控制器，仅仅是将这个文件载入到内存中；而还可以载入一定规则的扩展基础控制器，这里载入的是：<code>APPPATH . 'core/' . $CFG-&gt;config['subclass_prefix'] . 'Controller.php'</code>。<br>
其实说白了，默认的情况下配置中的 <code>subclass_prefix</code> 为 <code>MY_</code>，并且注意看路径的开头，是 <code>APPPATH</code>，因此可以在应用目录下的 <code>core</code> 目录下，书写一个类库，命名为  <code>MY_Controller</code>，并且继承 <code>CI_Controller</code>，如此可以扩展基础控制器功能。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// application/core/MY_Controller.php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">MY_Controller</span> <span class="token keyword">extends</span> <span class="token class-name">CI_Controller</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><em>这里了解这个知识点，在后面会专门学习扩展、复写基础控制器，基础模型等。</em></p> <h3 id="_2-21-路由分发"><a href="#_2-21-路由分发" class="header-anchor">#</a> 2.21 路由分发</h3> <p>基于上面加载的一些类库，将当前请求地址解析，得到最终会分发到的控制器、方法。<br>
然后载入该文件，并回调其解析的方法。</p> <h2 id="_3-综述"><a href="#_3-综述" class="header-anchor">#</a> 3. 综述</h2> <p>从上述的一些简单总结中可以看到，就这样一个设计，就可以完全实现项目的功能，并且它还是可扩展的，还是这么的轻量。<br>
虽然大部分的类库，都是懒加载的，减轻了服务器压力，但确实很多东西都需要手动处理确实也比较麻烦。<br>
总之，如果想要性能极高和足够简单和轻量，这个框架没问题；如果是想要功能大而全的，很多东西都是约定好的，直接配置或简单指定就可实现的，可以使用现代化的框架，比如 <code>Laravel</code>。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/php/ci3/entrance.html" class="prev">
        入口
      </a></span> <span class="next"><a href="/php/ci3/custom_exception_error.html">
        自定义异常错误处理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a2be46e1.js" defer></script><script src="/assets/js/2.c4a55d75.js" defer></script><script src="/assets/js/59.2dd1e634.js" defer></script>
  </body>
</html>
